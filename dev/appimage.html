


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Portable rootless xonsh build on AppImage &#8212; xonsh 0.9.13.dev5 documentation</title>
    <link rel="stylesheet" href="_static/numpy_friendly.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.base.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>
    <link rel="shortcut icon" href="_static/magic_conch.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Updating and customizing xonsh" href="customization.html" />
    <link rel="prev" title="Windows Guide" href="windows.html" />
     
        <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://xon.sh/appimage.html"/>

  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="customization.html" title="Updating and customizing xonsh"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="windows.html" title="Windows Guide"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="sidebar.html">xonsh 0.9.13.dev5 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">the xonsh shell</a> &#187;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="portable-rootless-xonsh-build-on-appimage">
<h1>Portable rootless xonsh build on AppImage<a class="headerlink" href="#portable-rootless-xonsh-build-on-appimage" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://appimage.org/">AppImage</a> is a format for distributing portable software on Linux without needing superuser permissions to install the application. It tries also to allow Linux distribution-agnostic binary software deployment for application developers, also called Upstream packaging.</p>
<p>AppImage allows xonsh to be run on any AppImage supported Linux distributive without installation and root access.</p>
<p align="center"><a href="https://asciinema.org/a/9AH5AtYxbrn5nRo83nm46Z34n" target="_blank"><img src="https://asciinema.org/a/9AH5AtYxbrn5nRo83nm46Z34n.svg" /></a></p><div class="section" id="try-it-now">
<h2>Try it now<a class="headerlink" href="#try-it-now" title="Permalink to this headline">¶</a></h2>
<p>You can download and try <a class="reference external" href="https://github.com/anki-code/appimage-xonsh">prebuilded xonsh.AppImage</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://github.com/anki-code/appimage-xonsh/raw/master/xonsh-x86_64.AppImage <span class="o">&amp;&amp;</span> chmod +x xonsh-x86_64.AppImage
./xonsh-x86_64.AppImage
./xonsh-x86_64.AppImage --help
</pre></div>
</div>
</div>
<div class="section" id="build-xonsh-appimage">
<h2>Build xonsh.AppImage<a class="headerlink" href="#build-xonsh-appimage" title="Permalink to this headline">¶</a></h2>
<p>Let’s start:</p>
<ol class="arabic simple">
<li><p>Run docker with <code class="docutils literal notranslate"><span class="pre">fuse</span></code>:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo docker run --rm -it --privileged --device /dev/fuse -v <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/appimage ubuntu:16.04 bash
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Install libraries for future building:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt update -y <span class="o">&amp;&amp;</span> apt upgrade -y
apt install -y fuse wget mc <span class="se">\</span>
                build-essential python-dev python-setuptools python-pip python-smbus <span class="se">\</span>
                libncursesw5-dev libgdbm-dev libc6-dev  <span class="se">\</span>
                zlib1g-dev libsqlite3-dev tk-dev <span class="se">\</span>
                libssl-dev openssl <span class="se">\</span>
                libffi-dev autoconf libfuse-dev
</pre></div>
</div>
<p>Not all required. Feel free to clean.</p>
<ol class="arabic simple" start="3">
<li><p>Getting the build scripts based on <a class="reference external" href="https://github.com/niess/linuxdeploy-plugin-python">linuxdeploy plugin python</a>:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir -p /appimage <span class="o">&amp;&amp;</span> <span class="nb">cd</span> /appimage
wget https://github.com/anki-code/linuxdeploy-plugin-python/archive/entrypoint.zip -O linuxdeploy-plugin-python-entrypoint.zip
unzip linuxdeploy-plugin-python-entrypoint.zip
</pre></div>
</div>
<p>Here we see downloading of <code class="docutils literal notranslate"><span class="pre">entrypoint</span></code> branch from <code class="docutils literal notranslate"><span class="pre">anki-code/linuxdeploy-plugin-python</span></code> because the origin <code class="docutils literal notranslate"><span class="pre">niess/linuxdeploy-plugin-python</span></code> repository has not yet accepted the <a class="reference external" href="https://github.com/niess/linuxdeploy-plugin-python/pull/11">pull request with xonsh</a>.</p>
<ol class="arabic simple" start="4">
<li><p>Building:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> linuxdeploy-plugin-python-entrypoint/appimage
./build-python.sh xonsh
<span class="nb">cd</span> ../ <span class="o">&amp;&amp;</span> ls -l
</pre></div>
</div>
<p>As result you’ll find executable file <code class="docutils literal notranslate"><span class="pre">xonsh-x86_64.AppImage</span></code> that runs xonsh and can take command line arguments like xonsh:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># ./xonsh-x86_64.AppImage -c &quot;echo @(1+1)&quot;</span>
<span class="m">2</span>
</pre></div>
</div>
<p>Enjoy!</p>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="glibs-versions">
<h3>GLIBs versions<a class="headerlink" href="#glibs-versions" title="Permalink to this headline">¶</a></h3>
<p>You can noticed that we build AppImage in docker with older version of Ubuntu (16.04) to avoid error with core libraries versions when binary compiled on modern version can’t use older version of libraries. In this nasty case you can see the error like <code class="docutils literal notranslate"><span class="pre">/xonsh-x86_64.AppImage:</span> <span class="pre">/lib/x86_64-linux-gnu/libc.so.6:</span> <span class="pre">version</span> <span class="pre">GLIBC_2.25</span> <span class="pre">not</span> <span class="pre">found</span> <span class="pre">(required</span> <span class="pre">by</span> <span class="pre">/ppp/xonsh-x86_64.AppImage)</span></code>. This means you should rebuild the AppImage for older version of distributive. If you know how to fix it once and forever feel free to tell us.</p>
</div>
<div class="section" id="windows-subsystem-for-linux-v1-wsl1">
<h3>Windows Subsystem for Linux v1 (WSL1)<a class="headerlink" href="#windows-subsystem-for-linux-v1-wsl1" title="Permalink to this headline">¶</a></h3>
<p>Need WSL support:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wsl1# ./xonsh-x86_64.AppImage
fuse: device not found, try <span class="s1">&#39;modprobe fuse&#39;</span> first

Cannot mount AppImage, please check your FUSE setup.
You might still be able to extract the contents of this AppImage
<span class="k">if</span> you run it with the --appimage-extract option.
See https://github.com/AppImage/AppImageKit/wiki/FUSE
<span class="k">for</span> more information
open dir error: No such file or directory
</pre></div>
</div>
<p>Workaround is extracting appimage and run manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wsl1$ ./xonsh --appimage-extract
wsl1$ ./squashfs-root/usr/bin/python3.7
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="sidebar.html" title="sidebar">
          <img class="logo" src="_static/ascii_conch_part_transparent_tight.png" alt="Logo"/>
        </a></p><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="sidebar.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Portable rootless xonsh build on AppImage</a><ul>
<li><a class="reference internal" href="#try-it-now">Try it now</a></li>
<li><a class="reference internal" href="#build-xonsh-appimage">Build xonsh.AppImage</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#glibs-versions">GLIBs versions</a></li>
<li><a class="reference internal" href="#windows-subsystem-for-linux-v1-wsl1">Windows Subsystem for Linux v1 (WSL1)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="windows.html"
                          title="Previous page">&larr; Windows Guide</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="customization.html"
                          title="Next page">&rarr; Updating and customizing xonsh</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/appimage.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="customization.html" title="Updating and customizing xonsh"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="windows.html" title="Windows Guide"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="sidebar.html">xonsh 0.9.13.dev5 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >the xonsh shell</a> &#187;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Anthony Scopatz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>